
  About this manual
  ~~~~~~~~~~~~~~~~~
  Webacula basic features see in README file.
  This manual should give you to install or upgrade Webacula installation.
  If you find errors, typos or just think there are things missing please file a bug report at 
    http://sourceforge.net/tracker/?group_id=201199
  Thanks.



  System Requirements
  ~~~~~~~~~~~~~~~~~~~

Run from command line:
  docs/check_system_requirements.php

Webacula also requires:
- Bacula 5.0 or later.
- Zend Framework version 1.10.0 or later.
- Zend Framework is built with object-oriented PHP 5 and requires
  PHP 5.2.4 or later with PDO extension active. Please see the system requirements appendix for
  more detailed information:
  http://framework.zend.com/manual/en/requirements.html
- Apache and mod_rewrite or equivalent web-server. For example, nginx and ngx_http_rewrite_module.
- Installed php-gd package. GD is an open source code library for the dynamic creation of images.
- Installed http://php.net/dom for use RSS feed.
- Browser compatibility: all jQuery UI plugins are tested for IE 6.0+, Firefox 3+, Safari 3.1+, Opera 9.6+, Google Chrome.



    Install
    ~~~~~~~

- Login as root
- Make directory '/var/www/webacula', for example.
- Copy this distribution to directory '/var/www/webacula'

- Download minimal Zend Framework package from http://framework.zend.com/ and extract.
  Copy the contents from directory 'ZendFramework-*.*.*-minimal/library/Zend' to 'webacula/library/Zend'

NOTE. If you use the Zend Framework for multiple sites, then you can place it in a folder that is part of 
your PHP include path. By doing this, you will have access to the Zend Framework components in all PHP scripts.

- The tree which should turn out as a result :

/var/www/webacula/
|-- application
|   |-- controllers
|   |-- models
|   `-- views
...
|-- data
|   |-- cache
|   |-- session
|   `-- tmp
...
|-- docs
|-- install
|-- html
|-- languages
`-- library
    |-- MyClass
    `-- Zend (here is Zend Framework package)
        |-- Acl
        |-- Auth
        |-- Cache
       ...


Some directory description:
  data/           This directory and files in it must NOT be available to access through the client Web-browser.
  data/cache/     Cache directory for Zend_Cache. Should be available to writing the Web-server.
  data/session/   Storage for PHP session. Should be available to writing the Web-server.
  data/tmp/       Directory "tmpdir" which will be saved the file, which contains a list of files to restore.
                  IMPORTANT!  This directory and files in it should be available to read the Director service and
                              to writing the Web-server.

- Specify the parameters to connect to the Catalog database, timezone and other in 'application/config.ini'
- Creates system group account (if not yet created) :
    groupadd bacula

- Add apache to group:
    usermod -aG bacula apache

- Next, bconsole file can be executed by Apache web server :
  IMPORTANT. Check '/usr/sbin/bconsole' it should be the binary ELF file, not a shell script!

  Variant 1
  ~~~~~~~~~
    chown root:bacula /usr/sbin/bconsole
    chmod u=rwx,g=rx,o=  /usr/sbin/bconsole

    chown root:bacula /etc/bacula/bconsole.conf
    chmod u=rw,g=r,o= /etc/bacula/bconsole.conf

   edit application/config.ini
       bacula.sudo = ""
       bacula.bconsole = "/usr/sbin/bconsole"


  Variant 2
  ~~~~~~~~~
    edit application/config.ini
       bacula.sudo = "/usr/bin/sudo"
       bacula.bconsole = "/usr/sbin/bconsole"

    visudo
        # (!!! comment here !!!) Defaults requiretty
        apache ALL=NOPASSWD: /usr/sbin/bconsole

- Check this :
# su -l apache -s /bin/sh -c "/usr/bin/sudo /usr/sbin/bconsole -n -c /etc/bacula/bconsole.conf"

- Configuration for Apache see 'install/apache/webacula.conf'
  NOTE. Specific directories on your system may be different.

- Next,  restart your Web-server.

  mod_rewrite
  ~~~~~~~~~~~
- Setup mod_rewrite see 'html/.htaccess'. Edit 'RewriteBase' if necessary.
  NOTE. Specific directories on your system may be different.

- Check mod_rewrite installed :
apachectl -t -D DUMP_MODULES 2>&1 | grep rewrite
rewrite_module (shared)

For testing mod_rewrite change 'RewriteBase', if necessary, in webacula/html/test_mod_rewrite/.htaccess
And use URL like
   http://localhost/webacula/test_mod_rewrite/
for test mod_rewrite

  PHP
  ~~~
- increase values in '/etc/php.ini' :
  memory_limit = 32M
  max_execution_time = 3600


TODO

- To show messages of the Job output, you must add a line :

  catalog = all, !skipped, !saved

  in bacula-dir.conf and restart Bacula Director :

Messages {
  Name = Standard
...
  catalog = all, !skipped, !saved
}

See also manual of Bacula "Chapter 15. Messages Resource".

- Next :
cd /etc/bacula
./bacula stop
./bacula start


If necessary change a name and the password of the user in a files in install/ directory:
TODO

Create database, tables and user :
   cd install

for MySQL:
TODO

for PostgreSQL:
TODO

for Sqlite:
TODO

TODO production .htaccess


    LogBook
    ~~~~~~~
    Logbook - is simple electronic journal of backups. Records in logbook are insert, modify, delete manually by the operator.
Records can contain links (usual web-links on which it is possible to click) to Bacula Jobs or links to other records of this logbook.
In logbook insert  records, for example, about Jobs, failures of the equipment, supernumerary situations, etc.
See screenshots http://webacula.sourceforge.net/ Webacula Web site for details.



    Update
    ~~~~~~
TODO
Кратко описать как перенести таблицы logbook, и т.п.
Изменения в config.ini
   Download latest tarball.
   Save in safe place your "config.ini", remove directory "webacula", extract Webacula source code and replace "config.ini" back.
   Run necessary script from update/ directory.
